$(function(){$(".button-checkbox").each(function(){function a(){var a=e.is(":checked");d.data("state",a?"on":"off"),d.find(".state-icon").removeClass().addClass("state-icon "+g[d.data("state")].icon),a?d.removeClass("btn-default").addClass("btn-"+f+" active"):d.removeClass("btn-"+f+" active").addClass("btn-default")}function b(){a(),0==d.find(".state-icon").length&&d.prepend('<i class="state-icon '+g[d.data("state")].icon+'"></i>')}var c=$(this),d=c.find("button"),e=c.find("input:checkbox"),f=d.data("color"),g={on:{icon:"glyphicon glyphicon-check"},off:{icon:"glyphicon glyphicon-unchecked"}};d.on("click",function(){e.prop("checked",!e.is(":checked")),e.triggerHandler("change"),a()}),e.on("change",function(){a()}),b()})});